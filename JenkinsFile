pipeline {
   agent any

   stages {
      stage('Hello') {
         steps {
            echo 'Hello Pipeline World'
         }
      }
       stage('Unit & Integration Tests') {
                  steps {
                      script {
                          try {
                              sh './gradlew test' //run a gradle task
                          } finally {
                              junit '**/build/test-results/test/*.xml' //make the junit test results available in any case (success & failure)
                          }
                      }
                  }
       }
   }

   post {
        always {
            cleanWs()
        }
   }

}